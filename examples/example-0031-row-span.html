<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
  <link rel="shortcut icon" type="image/ico" href="favicon.ico" />

	<title>SlickGrid Example: Basic Grid: Showing rowspan</title>
  <link rel="stylesheet" href="../dist/styles/css/example-demo.css" type="text/css"/>
  <link rel="stylesheet" href="../dist/styles/css/slick-alpine-theme.css" type="text/css"/>
	<style>
		.slick-row.even .slick-cell.cell-very-high {
        background: #F0FFE0;
    }
    .slick-row.odd .slick-cell.cell-var-span {
        background: #87ceeb;
    }
    .slick-cell.rowspan {
      background: white;
      z-index: 9;
    }
	</style>
</head>

<body>
  <h2 class="title">Example rowspan</h2>
  <div style="position:relative">
    <div style="width:650px;">
      <div class="grid-header" style="width:100%">
        <label>SlickGrid</label>
      </div>
      <div id="myGrid" class="slick-container" style="width:100%;height:500px;"></div>
    </div>

    <div class="options-panel">
      <h2>
        <a href="/examples/index.html" style="text-decoration: none; font-size: 22px">&#x2302;</a>
        Demonstrates:
      </h2>
      <p>
        This page demonstrates rowspan using DataView with item metadata.
      </p>
      <p>
        <b>NOTE</b>: "rowspan" is opt-in and requires the <code>enableCellRowSpan</code> grid option enabled to work properly.
      </p>
      <ul>
        <li>basic grid with minimal configuration</li>
        <li>Cells with rowspan > 1</li>

        <li>
          <button id='scrollTo'>Scroll To Row</button>
          <input id="nRow" type="text" value="100" style="width: 50px;" />
        </li>
        <li><button id='toggleSpans'>Toggle blue cell colspan &amp; rowspan</button></li>
      </ul>
			<h2>View Source:</h2>
      <ul>
          <li><A href="https://github.com/6pac/SlickGrid/blob/master/examples/example-0031-row-span.html" target="_sourcewindow"> View the source for this example on Github</a></li>
      </ul>
	</table>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs/Sortable.min.js"></script>
  <script src="sortable-cdn-fallback.js"></script>
	<script src="../dist/browser/slick.core.js"></script>
  <script src="../dist/browser/slick.interactions.js"></script>
  <script src="../dist/browser/slick.grid.js"></script>
  <script src="../dist/browser/slick.dataview.js"></script>
	<script type="text/javascript">
		var grid;
		var columns = [
      { id: "title", name: "Title", field: "title" },
      { id: "duration", name: "Duration", field: "duration" },
      { id: "%", name: "% Complete", sortable: true, field: "percentComplete", width: 100 },
      { id: "start", name: "Start", field: "start" },
      { id: "finish", name: "Finish", field: "finish" },
      { id: "effort-driven", name: "Effort Driven", field: "effortDriven", width: 100 }
    ];

		var options = {
			//enableAddRow: true,
			enableCellNavigation: true,
			enableColumnReorder: true,
      enableCellRowSpan: true,
		};

    document.addEventListener("DOMContentLoaded", function() {
			var data = [];
			var metadata = {
				2: {
					columns: {
						0: { rowspan: 3 },
						3: { colspan: 2 }
					}
				},
				3: {
					columns: {
						1: { rowspan: 5, colspan: 1, cssClass: "cell-var-span" }
					}
				},
				4: {
					columns: {
						3: { rowspan: 1999, colspan: 2, cssClass: "cell-very-high" }
					}
				},
			};

			for (var i = 0; i < 500; i++) {
				data[i] = {
          id: i,
					title: "Task " + i,
          duration: "5 days",
          percentComplete: Math.min(100, Math.round(Math.random() * 110)),
          start: "01/01/2009",
          finish: "01/05/2009",
          effortDriven: (i % 5 == 0)
				};
			}

      const dataView = new Slick.Data.DataView();
      dataView.getItemMetadata = (row) => {
        return metadata[row];
      };
			grid = new Slick.Grid("#myGrid", dataView, columns, options);

      dataView.onRowCountChanged.subscribe(function (e, args) {
        grid.updateRowCount();
        grid.render();
      });

      dataView.onRowsChanged.subscribe(function (e, args) {
        grid.invalidateRows(args.rows);
        grid.render();
      });

      grid.init();

      dataView.beginUpdate();
      dataView.setItems(data);
      dataView.endUpdate();

      document.querySelector("#toggleSpans").addEventListener('click', function (e) {
				var cell = metadata[3].columns[1];
        if (cell.colspan === 1) {
            cell.rowspan = 3;
            cell.colspan = 2;
        } else {
            cell.rowspan = 5;
            cell.colspan = 1;
        }
		    // row index 3 can have a rowspan of up to 5 rows, so we need to invalidate from row 3 + 5 (-1 because of zero index)
        // so: 3 + 5 - 1 => row indexes 3 to 7
        grid.invalidateRows([3, 4, 5, 6, 7]);
        grid.render();
			});

      document.querySelector("#scrollTo").addEventListener('click', function (e) {
				grid.scrollRowToTop(document.querySelector('#nRow').value);
			});

      document.querySelector("#nRow").addEventListener('keydown', function (e) {
				if (e.keyCode == 13)
        document.querySelector('#scrollTo').click();
			});
		});
	</script>
</body>
</html>