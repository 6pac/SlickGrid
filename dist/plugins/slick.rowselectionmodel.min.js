/**
 * SlickGrid v4.0.0
 * (c) 2009-present Michael Leibman
 * homepage: http://github.com/mleibman/slickgrid
 * license: MIT
 * date: 2023-06-28
 * file: ./plugins/slick.rowselectionmodel.js
 */
!function(e){Slick.Utils.extend(!0,e,{Slick:{RowSelectionModel:function(t){var c,n,l,o,i,s=[],r=this,a=new Slick.EventHandler,u={selectActiveRow:!0,dragToSelect:!1,autoScrollWhenDrag:!0,cellRangeSelector:void 0};function g(e){return function(){n||(n=!0,e.apply(this,arguments),n=!1)}}function w(e){for(var t=[],n=0;n<e.length;n++)for(var l=e[n].fromRow;l<=e[n].toRow;l++)t.push(l);return t}function S(e){for(var t=[],n=c.getColumns().length-1,l=0;l<e.length;l++)t.push(new Slick.Range(e[l],0,e[l],n));return t}function f(){return w(s)}function e(e){d(S(e),"SlickRowSelectionModel.setSelectedRows")}function d(e,t){(s&&0!==s.length||e&&0!==e.length)&&(s=e,e=new Slick.EventData(null,s),Object.defineProperty(e,"detail",{writable:!0,configurable:!0,value:{caller:t||"SlickRowSelectionModel.setSelectedRanges"}}),r.onSelectedRangesChanged.notify(s,e))}function h(e,t){l.selectActiveRow&&null!=t.row&&d([new Slick.Range(t.row,0,t.row,c.getColumns().length-1)])}function R(e){var t,n,l=c.getActiveCell();!(c.getOptions().multiSelect&&l&&e.shiftKey)||e.ctrlKey||e.altKey||e.metaKey||e.which!=Slick.keyCode.UP&&e.which!=Slick.keyCode.DOWN||((n=f()).sort(function(e,t){return e-t}),t=(n=n.length?n:[l.row])[0],n=n[n.length-1],0<=(l=e.which==Slick.keyCode.DOWN?l.row<n||t==n?++n:++t:l.row<n?--n:--t)&&l<c.getDataLength()&&(c.scrollRowIntoView(l),d(S(function(e,t){for(var n=[],l=e;l<=t;l++)n.push(l);for(l=t;l<e;l++)n.push(l);return n}(t,n)))),e.preventDefault(),e.stopPropagation())}function v(e){var t=c.getCellFromEvent(e);if(!t||!c.canCellBeActive(t.row,t.cell))return!1;if(!c.getOptions().multiSelect||!e.ctrlKey&&!e.shiftKey&&!e.metaKey)return!1;var n=(i=w(s)).indexOf(t.row);if(-1===n&&(e.ctrlKey||e.metaKey))i.push(t.row),c.setActiveCell(t.row,t.cell);else if(-1!==n&&(e.ctrlKey||e.metaKey))i=i.filter(e=>e!==t.row),c.setActiveCell(t.row,t.cell);else if(i.length&&e.shiftKey){for(var l=i.pop(),n=Math.min(t.row,l),o=Math.max(t.row,l),i=[],r=n;r<=o;r++)r!==l&&i.push(r);i.push(l),c.setActiveCell(t.row,t.cell)}return d(S(i)),e.stopImmediatePropagation(),!0}function C(e,t){var n;if(i||(n=c.getPluginByName("RowMoveManager")||c.getPluginByName("CrossGridRowMoveManager"),i=n?n.isHandlerColumn:Slick.Utils.noop),c.getEditorLock().isActive()||i(t.cell))return e.stopPropagation(),!1;c.setActiveCell(t.row,t.cell)}function k(e,t){if(!c.getOptions().multiSelect||!l.selectActiveRow)return!1;d([new Slick.Range(t.range.fromRow,0,t.range.toRow,c.getColumns().length-1)])}Slick.Utils.extend(this,{getSelectedRows:f,setSelectedRows:e,getSelectedRanges:function(){return s},setSelectedRanges:d,refreshSelections:function(){e(f())},init:function(e){if(void 0===Slick.Draggable)throw new Error('Slick.Draggable is undefined, make sure to import "slick.interactions.js"');if(l=Slick.Utils.extend(!0,{},u,t),o=l.cellRangeSelector,c=e,!o&&l.dragToSelect){if(!Slick.CellRangeDecorator)throw new Error("Slick.CellRangeDecorator is required when option dragToSelect set to true");o=new Slick.CellRangeSelector({selectionCss:{border:"none"},autoScroll:l.autoScrollWhenDrag})}a.subscribe(c.onActiveCellChanged,g(h)),a.subscribe(c.onKeyDown,g(R)),a.subscribe(c.onClick,g(v)),o&&(e.registerPlugin(o),o.onCellRangeSelecting.subscribe(k),o.onCellRangeSelected.subscribe(k),o.onBeforeCellRangeSelected.subscribe(C))},destroy:function(){a.unsubscribeAll(),o&&(o.onCellRangeSelecting.unsubscribe(k),o.onCellRangeSelected.unsubscribe(k),o.onBeforeCellRangeSelected.unsubscribe(C),c.unregisterPlugin(o),o.destroy)&&o.destroy()},pluginName:"RowSelectionModel",onSelectedRangesChanged:new Slick.Event})}}})}(window);