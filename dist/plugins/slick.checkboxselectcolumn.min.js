/**
 * SlickGrid v4.0.0-beta.0
 * (c) 2009-present Michael Leibman
 * homepage: http://github.com/mleibman/slickgrid
 * license: MIT
 * date: 2023-05-17
 * file: ./plugins/slick.checkboxselectcolumn.js
 */
!function(e){Slick.Utils.extend(!0,e,{Slick:{CheckboxSelectColumn:function(e){let d,u,h=!1,f=null,g,p=w(),t=new Slick.EventHandler,m={},b=!1,n=new Slick.BindingEventService,k=Slick.Utils.extend(!0,{},{columnId:"_checkbox_selector",cssClass:null,hideSelectAllCheckbox:!1,toolTip:"Select/Deselect All",width:30,applySelectOnAllPages:!1,hideInColumnTitleRow:!1,hideInFilterHeaderRow:!0},e);"function"==typeof k.selectableOverride&&R(k.selectableOverride);function l(){u.updateColumnHeader(k.columnId,"","")}function o(){var e=g&&g.querySelector("#filter-checkbox-selectall-container");e&&(e.style.display="none")}function c(){var e=u.getSelectedRows();let t={},l,o,c,n=0;if("function"==typeof f)for(c=0;c<u.getDataLength();c++){var i=u.getDataItem(c);x(o,i,u)||n++}var r,d=[];for(o=0;o<e.length;o++){l=e[o];var a=u.getDataItem(l);x(o,a,u)?(t[l]=!0,t[l]!==m[l]&&(u.invalidateRow(l),delete m[l])):d.push(l)}for(o in m)u.invalidateRow(o);if(m=t,u.render(),b=e&&e.length+n>=u.getDataLength(),h&&k.applySelectOnAllPages||(k.hideInColumnTitleRow||k.hideSelectAllCheckbox||y(b),k.hideInFilterHeaderRow)||(r=g&&g.querySelector("#header-filter-selector"+p))&&(r.checked=b),0<d.length){for(o=0;o<d.length;o++){var s=e.indexOf(d[o]);e.splice(s,1)}u.setSelectedRows(e,"click.cleanup")}}function i(){var e=d.getAllSelectedFilteredIds(),o=d.getFilteredItems();let c=0;if("function"==typeof f&&0<e.length)for(let e=0;e<d.getItemCount();e++){var n=d.getItemByIdx(e);let t=d.getIdPropertyName(),l=n[t];0<=o.findIndex(function(e){return e[t]===l})&&!x(e,n,u)&&c++}b=(e&&e.length)+c>=o.length,k.hideInColumnTitleRow||k.hideSelectAllCheckbox||y(b),k.hideInFilterHeaderRow||(e=g&&g.querySelector("#header-filter-selector"+p))&&(e.checked=b)}function r(e,t){32==e.which&&u.getColumns()[t.cell].id===k.columnId&&(u.getEditorLock().isActive()&&!u.getEditorLock().commitCurrentEdit()||s(t.row),e.preventDefault(),e.stopImmediatePropagation())}function a(e,t){u.getColumns()[t.cell].id===k.columnId&&"checkbox"===e.target.type&&(u.getEditorLock().isActive()&&!u.getEditorLock().commitCurrentEdit()?e.preventDefault():(s(t.row),e.stopPropagation()),e.stopImmediatePropagation())}function s(t){var e=u.getDataItem(t);x(t,e,u)&&(m[t]?(e=u.getSelectedRows().filter(e=>e!==t),u.setSelectedRows(e,"click.toggle")):u.setSelectedRows(u.getSelectedRows().concat(t),"click.toggle"),u.setActiveCell(t,function(){if(null===C){C=0;var t=u.getColumns();for(let e=0;e<t.length;e++)t[e].id==k.columnId&&(C=e)}return C}()))}function S(t,l){if(l.column.id==k.columnId&&"checkbox"===t.target.type){if(u.getEditorLock().isActive()&&!u.getEditorLock().commitCurrentEdit())t.preventDefault();else{let e=t.target.checked;var l=e?"click.selectAll":"click.unselectAll",o=[];if(e){for(let e=0;e<u.getDataLength();e++){var c=u.getDataItem(e);c.__group||c.__groupTotals||!x(e,c,u)||o.push(e)}e=!0}if(h&&d&&k.applySelectOnAllPages){var n=[],i=d.getFilteredItems();for(let e=0;e<i.length;e++){var r=i[e];x(e,r,u)&&n.push(r[d.getIdPropertyName()])}d.setSelectedIds(n,{isRowBeingAdded:e})}u.setSelectedRows(o,l),t.stopPropagation()}t.stopImmediatePropagation()}}let C=null;function w(){return Math.round(1e7*Math.random())}function I(e,t,l,o,c,n){var i=w()+e;return c&&x(e,c,n)?m[e]?"<input id='selector"+i+"' type='checkbox' checked='checked'><label for='selector"+i+"'></label>":"<input id='selector"+i+"' type='checkbox'><label for='selector"+i+"'></label>":null}function x(e,t,l){return"function"!=typeof f||f(e,t,l)}function y(e){e?u.updateColumnHeader(k.columnId,"<input id='header-selector"+p+"' type='checkbox' checked='checked'><label for='header-selector"+p+"'></label>",k.toolTip):u.updateColumnHeader(k.columnId,"<input id='header-selector"+p+"' type='checkbox'><label for='header-selector"+p+"'></label>",k.toolTip)}function R(e){f=e}Slick.Utils.extend(this,{init:function(e){u=e,(h=!Array.isArray(e.getData()))&&(d=e.getData()),t.subscribe(u.onSelectedRowsChanged,c).subscribe(u.onClick,a).subscribe(u.onKeyDown,r),h&&d&&k.applySelectOnAllPages&&t.subscribe(d.onSelectedRowIdsChanged,i).subscribe(d.onPagingInfoChanged,i),k.hideInFilterHeaderRow||(e=e,t.subscribe(e.onHeaderRowCellRendered,function(e,t){var l,o,c;"sel"===t.column.field&&(Slick.Utils.emptyElement(t.node),(l=document.createElement("span")).id="filter-checkbox-selectall-container",(o=document.createElement("input")).type="checkbox",o.id="header-filter-selector"+p,(c=document.createElement("label")).htmlFor="header-filter-selector"+p,l.appendChild(o),l.appendChild(c),t.node.appendChild(l),g=t.node,n.bind(l,"click",e=>S(e,t)))})),k.hideInColumnTitleRow||t.subscribe(u.onHeaderClick,S)},destroy:function(){t.unsubscribeAll(),n.unbindAll()},pluginName:"CheckboxSelectColumn",deSelectRows:function(e){let t,l=e.length,o=[];for(t=0;t<l;t++)m[e[t]]&&(o[o.length]=e[t]);u.setSelectedRows(u.getSelectedRows().filter(e=>o.indexOf(e)<0),"SlickCheckboxSelectColumn.deSelectRows")},selectRows:function(e){let t,l=e.length,o=[];for(t=0;t<l;t++)m[e[t]]||(o[o.length]=e[t]);u.setSelectedRows(u.getSelectedRows().concat(o),"SlickCheckboxSelectColumn.selectRows")},getColumnDefinition:function(){return{id:k.columnId,name:k.hideSelectAllCheckbox||k.hideInColumnTitleRow?"":"<input id='header-selector"+p+"' type='checkbox'><label for='header-selector"+p+"'></label>",toolTip:k.hideSelectAllCheckbox||k.hideInColumnTitleRow?"":k.toolTip,field:"sel",width:k.width,resizable:!1,sortable:!1,cssClass:k.cssClass,hideSelectAllCheckbox:k.hideSelectAllCheckbox,formatter:I}},getOptions:function(){return k},selectableOverride:R,setOptions:function(e){(k=Slick.Utils.extend(!0,{},k,e)).hideSelectAllCheckbox?(l(),o()):(k.hideInColumnTitleRow?l():(y(b),t.subscribe(u.onHeaderClick,S)),k.hideInFilterHeaderRow?o():(e=g.querySelector("#filter-checkbox-selectall-container"))&&(e.style.display="flex",e=e.querySelector('input[type="checkbox"]'))&&(e.checked=b))}})}}})}(window);