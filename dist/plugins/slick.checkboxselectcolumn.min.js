/**
 * SlickGrid v4.0.0
 * (c) 2009-present Michael Leibman
 * homepage: http://github.com/mleibman/slickgrid
 * license: MIT
 * date: 2023-06-28
 * file: ./plugins/slick.checkboxselectcolumn.js
 */
!function(e){Slick.Utils.extend(!0,e,{Slick:{CheckboxSelectColumn:function(e){let d,s,h=!1,f=null,m,g=w(),t=new Slick.EventHandler,p={},b=!1,n=new Slick.BindingEventService,k=Slick.Utils.extend(!0,{},{columnId:"_checkbox_selector",cssClass:null,hideSelectAllCheckbox:!1,toolTip:"Select/Deselect All",width:30,applySelectOnAllPages:!1,hideInColumnTitleRow:!1,hideInFilterHeaderRow:!0},e);"function"==typeof k.selectableOverride&&y(k.selectableOverride);function l(){s.updateColumnHeader(k.columnId,"","")}function o(){var e=m&&m.querySelector("#filter-checkbox-selectall-container");e&&(e.style.display="none")}function c(){var e=s.getSelectedRows();let t={},l,o,c,n=0;if("function"==typeof f)for(c=0;c<s.getDataLength();c++){var i=s.getDataItem(c);I(o,i,s)||n++}var r,d=[];for(o=0;o<e.length;o++){l=e[o];var a=s.getDataItem(l);I(o,a,s)?(t[l]=!0,t[l]!==p[l]&&(s.invalidateRow(l),delete p[l])):d.push(l)}for(o in p)s.invalidateRow(o);if(p=t,s.render(),b=e&&e.length+n>=s.getDataLength(),h&&k.applySelectOnAllPages||(k.hideInColumnTitleRow||k.hideSelectAllCheckbox||v(b),k.hideInFilterHeaderRow)||(r=m&&m.querySelector("#header-filter-selector"+g))&&(r.checked=b),0<d.length){for(o=0;o<d.length;o++){var u=e.indexOf(d[o]);e.splice(u,1)}s.setSelectedRows(e,"click.cleanup")}}function i(){var e=d.getAllSelectedFilteredIds(),o=d.getFilteredItems();let c=0;if("function"==typeof f&&0<e.length)for(let e=0;e<d.getItemCount();e++){var n=d.getItemByIdx(e);let t=d.getIdPropertyName(),l=n[t];0<=o.findIndex(function(e){return e[t]===l})&&!I(e,n,s)&&c++}b=(e&&e.length)+c>=o.length,k.hideInColumnTitleRow||k.hideSelectAllCheckbox||v(b),k.hideInFilterHeaderRow||(e=m&&m.querySelector("#header-filter-selector"+g))&&(e.checked=b)}function r(e,t){32==e.which&&s.getColumns()[t.cell].id===k.columnId&&(s.getEditorLock().isActive()&&!s.getEditorLock().commitCurrentEdit()||u(t.row),e.preventDefault(),e.stopImmediatePropagation())}function a(e,t){s.getColumns()[t.cell].id===k.columnId&&"checkbox"===e.target.type&&(s.getEditorLock().isActive()&&!s.getEditorLock().commitCurrentEdit()?e.preventDefault():(u(t.row),e.stopPropagation()),e.stopImmediatePropagation())}function u(t){var e=s.getDataItem(t);I(t,e,s)&&(p[t]?(e=s.getSelectedRows().filter(e=>e!==t),s.setSelectedRows(e,"click.toggle")):s.setSelectedRows(s.getSelectedRows().concat(t),"click.toggle"),s.setActiveCell(t,function(){if(null===S){S=0;var t=s.getColumns();for(let e=0;e<t.length;e++)t[e].id==k.columnId&&(S=e)}return S}()))}function C(t,l){if(l.column.id==k.columnId&&"checkbox"===t.target.type){if(s.getEditorLock().isActive()&&!s.getEditorLock().commitCurrentEdit())t.preventDefault();else{let e=t.target.checked;var l=e?"click.selectAll":"click.unselectAll",o=[];if(e){for(let e=0;e<s.getDataLength();e++){var c=s.getDataItem(e);c.__group||c.__groupTotals||!I(e,c,s)||o.push(e)}e=!0}if(h&&d&&k.applySelectOnAllPages){var n=[],i=d.getFilteredItems();for(let e=0;e<i.length;e++){var r=i[e];I(e,r,s)&&n.push(r[d.getIdPropertyName()])}d.setSelectedIds(n,{isRowBeingAdded:e})}s.setSelectedRows(o,l),t.stopPropagation()}t.stopImmediatePropagation()}}let S=null;function w(){return Math.round(1e7*Math.random())}function x(e,t,l,o,c,n){var i=w()+e;return c&&I(e,c,n)?p[e]?"<input id='selector"+i+"' type='checkbox' checked='checked'><label for='selector"+i+"'></label>":"<input id='selector"+i+"' type='checkbox'><label for='selector"+i+"'></label>":null}function I(e,t,l){return"function"!=typeof f||f(e,t,l)}function v(e){e?s.updateColumnHeader(k.columnId,"<input id='header-selector"+g+"' type='checkbox' checked='checked'><label for='header-selector"+g+"'></label>",k.toolTip):s.updateColumnHeader(k.columnId,"<input id='header-selector"+g+"' type='checkbox'><label for='header-selector"+g+"'></label>",k.toolTip)}function y(e){f=e}Slick.Utils.extend(this,{init:function(e){s=e,(h=!Array.isArray(e.getData()))&&(d=e.getData()),t.subscribe(s.onSelectedRowsChanged,c).subscribe(s.onClick,a).subscribe(s.onKeyDown,r),h&&d&&k.applySelectOnAllPages&&t.subscribe(d.onSelectedRowIdsChanged,i).subscribe(d.onPagingInfoChanged,i),k.hideInFilterHeaderRow||(e=e,t.subscribe(e.onHeaderRowCellRendered,function(e,t){var l,o,c;"sel"===t.column.field&&(Slick.Utils.emptyElement(t.node),(l=document.createElement("span")).id="filter-checkbox-selectall-container",(o=document.createElement("input")).type="checkbox",o.id="header-filter-selector"+g,(c=document.createElement("label")).htmlFor="header-filter-selector"+g,l.appendChild(o),l.appendChild(c),t.node.appendChild(l),m=t.node,n.bind(l,"click",e=>C(e,t)))})),k.hideInColumnTitleRow||t.subscribe(s.onHeaderClick,C)},destroy:function(){t.unsubscribeAll(),n.unbindAll()},pluginName:"CheckboxSelectColumn",deSelectRows:function(e){let t,l=e.length,o=[];for(t=0;t<l;t++)p[e[t]]&&(o[o.length]=e[t]);s.setSelectedRows(s.getSelectedRows().filter(e=>o.indexOf(e)<0),"SlickCheckboxSelectColumn.deSelectRows")},selectRows:function(e){let t,l=e.length,o=[];for(t=0;t<l;t++)p[e[t]]||(o[o.length]=e[t]);s.setSelectedRows(s.getSelectedRows().concat(o),"SlickCheckboxSelectColumn.selectRows")},getColumnDefinition:function(){return{id:k.columnId,name:k.hideSelectAllCheckbox||k.hideInColumnTitleRow?"":"<input id='header-selector"+g+"' type='checkbox'><label for='header-selector"+g+"'></label>",toolTip:k.hideSelectAllCheckbox||k.hideInColumnTitleRow?"":k.toolTip,field:"sel",width:k.width,resizable:!1,sortable:!1,cssClass:k.cssClass,hideSelectAllCheckbox:k.hideSelectAllCheckbox,formatter:x,excludeFromColumnPicker:void 0===k.excludeFromColumnPicker||k.excludeFromColumnPicker,excludeFromGridMenu:void 0===k.excludeFromGridMenu||k.excludeFromGridMenu,excludeFromHeaderMenu:void 0===k.excludeFromHeaderMenu||k.excludeFromHeaderMenu}},getOptions:function(){return k},selectableOverride:y,setOptions:function(e){(k=Slick.Utils.extend(!0,{},k,e)).hideSelectAllCheckbox?(l(),o()):(k.hideInColumnTitleRow?l():(v(b),t.subscribe(s.onHeaderClick,C)),k.hideInFilterHeaderRow?o():(e=m.querySelector("#filter-checkbox-selectall-container"))&&(e.style.display="flex",e=e.querySelector('input[type="checkbox"]'))&&(e.checked=b))}})}}})}(window);