/**
 * SlickGrid v4.0.1
 * (c) 2009-present Michael Leibman
 * homepage: http://github.com/mleibman/slickgrid
 * license: MIT
 * date: 2023-06-30
 * file: ./plugins/slick.cellmenu.js
 */
!function(e){Slick.Utils.extend(!0,e,{Slick:{Plugins:{CellMenu:function(t){let r,u=-1,m=-1,p,f,d="",l=new Slick.EventHandler,c=this,a,g,h,v=new Slick.BindingEventService,i={autoAdjustDrop:!0,autoAlignSide:!0,autoAdjustDropOffset:0,autoAlignSideOffset:0,hideMenuOnScroll:!0,maxHeight:"none",width:"auto"};function e(e){var t=p.getCellFromEvent(e),t=(u=t&&t.cell,m=t&&t.row,p.getColumns()[u]),l=p.getDataItem(m),i=r.commandItems||[],n=r.optionItems||[];if(t&&t.cellMenu&&(i.length||n.length)&&(b(),0!=c.onBeforeMenuShow.notify({cell:u,row:m,grid:p},e,c).getReturnValue())){var s=isNaN(r.maxHeight)?r.maxHeight:r.maxHeight+"px",o=isNaN(r.width)?r.width:r.width+"px",o=((h=document.createElement("div")).className="slick-cell-menu "+d,h.role="menu",h.style.width=o,h.style.maxHeight=s,h.style.top=e.pageY+5+"px",h.style.left=e.pageX+"px",h.style.display="none",document.createElement("button")),s=(o.type="button",o.className="close",o.dataset.dismiss="slick-cell-menu",o.ariaLabel="Close",document.createElement("span"));if(s.className="close",s.ariaHidden="true",s.innerHTML="&times;",o.appendChild(s),!r.hideOptionSection&&0<n.length&&((s=document.createElement("div")).className="slick-cell-menu-option-list",s.role="menu",r.hideCloseButton||(v.bind(o,"click",C),h.appendChild(o)),h.appendChild(s),function(e,l,i,n){if(n&&i&&e){e&&e.optionTitle&&((g=document.createElement("div")).className="title",g.textContent=e.optionTitle,l.appendChild(g));for(let t=0,e=i.length;t<e;t++){let e=!0;var s=i[t],o=y(s.itemVisibilityOverride,n),d=y(s.itemUsabilityOverride,n);o&&(Object.prototype.hasOwnProperty.call(s,"itemUsabilityOverride")&&(s.disabled=!d),(o=document.createElement("div")).className="slick-cell-menu-item",o.role="menuitem",!s.divider&&"divider"!==s||(o.classList.add("slick-cell-menu-item-divider"),e=!1),!s.disabled&&d||o.classList.add("slick-cell-menu-item-disabled"),s.hidden&&o.classList.add("slick-cell-menu-item-hidden"),s.cssClass&&o.classList.add(...s.cssClass.split(" ")),s.tooltip&&(o.title=s.tooltip),(d=document.createElement("div")).className="slick-cell-menu-icon",o.appendChild(d),s.iconCssClass&&d.classList.add(...s.iconCssClass.split(" ")),s.iconImage&&(d.style.backgroundImage="url("+s.iconImage+")"),(d=document.createElement("span")).className="slick-cell-menu-content",d.textContent=s.title,o.appendChild(d),s.textCssClass&&d.classList.add(...s.textCssClass.split(" ")),l.appendChild(o),e)&&v.bind(o,"click",S.bind(this,s))}}}(r,s,n,{cell:u,row:m,column:t,dataContext:l,grid:p})),!r.hideCommandSection&&0<i.length&&((s=document.createElement("div")).className="slick-cell-menu-command-list",s.role="menu",r.hideCloseButton||0!==n.length&&!r.hideOptionSection||(v.bind(o,"click",C),h.appendChild(o)),h.appendChild(s),function(e,l,i,n){if(n&&i&&e){e&&e.commandTitle&&((a=document.createElement("div")).className="title",a.textContent=e.commandTitle,l.appendChild(a));for(let t=0,e=i.length;t<e;t++){let e=!0;var s=i[t],o=y(s.itemVisibilityOverride,n),d=y(s.itemUsabilityOverride,n);o&&(Object.prototype.hasOwnProperty.call(s,"itemUsabilityOverride")&&(s.disabled=!d),(o=document.createElement("div")).className="slick-cell-menu-item",o.role="menuitem",!s.divider&&"divider"!==s||(o.classList.add("slick-cell-menu-item-divider"),e=!1),!s.disabled&&d||o.classList.add("slick-cell-menu-item-disabled"),s.hidden&&o.classList.add("slick-cell-menu-item-hidden"),s.cssClass&&o.classList.add(...s.cssClass.split(" ")),s.tooltip&&(o.title=s.tooltip),(d=document.createElement("div")).className="slick-cell-menu-icon",o.appendChild(d),s.iconCssClass&&d.classList.add(...s.iconCssClass.split(" ")),s.iconImage&&(d.style.backgroundImage="url("+s.iconImage+")"),(d=document.createElement("span")).className="slick-cell-menu-content",d.textContent=s.title,o.appendChild(d),s.textCssClass&&d.classList.add(...s.textCssClass.split(" ")),l.appendChild(o),e)&&v.bind(o,"click",w.bind(this,s))}}}(r,s,i,{cell:u,row:m,column:t,dataContext:l,grid:p})),h.style.display="block",document.body.appendChild(h),0!=c.onAfterMenuShow.notify({cell:u,row:m,grid:p},e,c).getReturnValue())return h}}function C(e){e.defaultPrevented||b(e)}function b(e,t){(h=h||document.querySelector(".slick-cell-menu."+d))&&h.remove&&0!=c.onBeforeMenuClose.notify({cell:t&&t.cell,row:t&&t.row,grid:p,menu:h},e,c).getReturnValue()&&(h.remove(),h=null)}function n(l,i){l instanceof Slick.EventData&&(l=l.getNativeEvent());var n=p.getCellFromEvent(l),s=p.getDataItem(n.row),n=p.getColumns()[n.cell];if(n&&n.cellMenu&&l.preventDefault(),r=Slick.Utils.extend({},r,n.cellMenu),(i=i||{}).columnDef=n,i.dataContext=s,i.grid=p,y(r.menuUsabilityOverride,i)){if(h=e(l)){{n=l;s=n.target.closest(".slick-cell"),i=s&&Slick.Utils.offset(s);let e=s?i.left:n.pageX,t=s?i.top:n.pageY;var o,i=s.offsetWidth||0,n=h&&h.offsetHeight||0,l=h&&h.offsetWidth||r.width||0,d=f.rowHeight,c=r.autoAdjustDropOffset,a=r.autoAlignSideOffset;r.autoAdjustDrop&&(o=Slick.Utils.calculateAvailableSpace(s).bottom,s=Slick.Utils.calculateAvailableSpace(s).top,o=o+c-d,t="top"==(o<n&&o<s-c+d?"top":"bottom")?(h.classList.remove("dropdown"),h.classList.add("dropup"),t-n-c):(h.classList.remove("dropup"),h.classList.add("dropdown"),t+d+c)),r.autoAlignSide&&(o=p.getGridPosition(),"left"==(e+l>=o.width?"left":"right")?(h.classList.remove("dropright"),h.classList.add("dropleft"),e=e-(l-i)-a):(h.classList.remove("dropleft"),h.classList.add("dropright"),e+=a)),h.style.top=t+"px",h.style.left=e+"px"}h.setAttribute("aria-expanded","true"),h.style.display="block"}v.bind(document.body,"mousedown",function(e){h==e.target||h&&h.contains(e.target)||e.defaultPrevented||k(e,{cell:u,row:m})}.bind(this))}}function k(e,t){h&&0!=c.onBeforeMenuClose.notify({cell:t&&t.cell,row:t&&t.row,grid:p,menu:h},e,c).getReturnValue()&&h&&h.remove&&(h.remove(),h=null)}function w(e,t){var l,i,n,s,o;!e||e.disabled||e.divider||"divider"===e||(o=e.command||"",l=m,i=u,n=p.getColumns()[i],s=p.getDataItem(l),null!==o&&""!==o&&(o={cell:i,row:l,grid:p,command:o,item:e,column:n,dataContext:s},c.onCommand.notify(o,t,c),"function"==typeof e.action&&e.action.call(this,t,o),t.defaultPrevented||k(t,{cell:i,row:l})))}function S(e,t){var l,i,n,s,o;!e||e.disabled||e.divider||"divider"===e||p.getEditorLock().commitCurrentEdit()&&(o=void 0!==e.option?e.option:"",l=m,i=u,n=p.getColumns()[i],s=p.getDataItem(l),void 0!==o)&&(o={cell:i,row:l,grid:p,option:o,item:e,column:n,dataContext:s},c.onOptionSelected.notify(o,t,c),"function"==typeof e.action&&e.action.call(this,t,o),t.defaultPrevented||k(t,{cell:i,row:l}))}function y(e,t){return"function"!=typeof e||e.call(this,t)}Slick.Utils.extend(this,{init:function(e){p=e,f=e.getOptions(),r=Slick.Utils.extend({},i,t),d=e&&e.getUID?e.getUID():"",l.subscribe(p.onClick,n),r.hideMenuOnScroll&&l.subscribe(p.onScroll,b)},closeMenu:b,destroy:function(){c.onAfterMenuShow.unsubscribe(),c.onBeforeMenuShow.unsubscribe(),c.onBeforeMenuClose.unsubscribe(),c.onCommand.unsubscribe(),c.onOptionSelected.unsubscribe(),l.unsubscribeAll(),v.unbindAll(),h&&h.remove&&h.remove(),a=null,g=null,h=null},pluginName:"CellMenu",setOptions:function(e){r=Slick.Utils.extend({},r,e)},onAfterMenuShow:new Slick.Event,onBeforeMenuShow:new Slick.Event,onBeforeMenuClose:new Slick.Event,onCommand:new Slick.Event,onOptionSelected:new Slick.Event})}}}})}(window);