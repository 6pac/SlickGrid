/**
 * SlickGrid v4.0.0
 * (c) 2009-present Michael Leibman
 * homepage: http://github.com/mleibman/slickgrid
 * license: MIT
 * date: 2023-06-28
 * file: ./plugins/slick.cellselectionmodel.js
 */
!function(e){Slick.Utils.extend(!0,e,{Slick:{CellSelectionModel:function(l){var s,n,o,a=[],t=this;n=void 0===l||void 0===l.cellRangeSelector?new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}):l.cellRangeSelector;var c={selectActiveCell:!0};function u(e){for(var l=[],n=0;n<e.length;n++){var o=e[n];s.canCellBeSelected(o.fromRow,o.fromCell)&&s.canCellBeSelected(o.toRow,o.toCell)&&l.push(o)}return l}function w(e,l){var n;(a&&0!==a.length||e&&0!==e.length)&&(n=!function(e,l){var n=e.length!==l.length;if(!n)for(var o=0;o<e.length;o++)if(e[o].fromCell!==l[o].fromCell||e[o].fromRow!==l[o].fromRow||e[o].toCell!==l[o].toCell||e[o].toRow!==l[o].toRow){n=!0;break}return!n}(a,e),a=u(e),n)&&(e=new Slick.EventData(null,a),Object.defineProperty(e,"detail",{writable:!0,configurable:!0,value:{caller:l||"SlickCellSelectionModel.setSelectedRanges"}}),t.onSelectedRangesChanged.notify(a,e))}function e(){return a}function i(e){if(s.getEditorLock().isActive())return e.stopPropagation(),!1}function r(e,l){s.setActiveCell(l.range.fromRow,l.range.fromCell,!1,!1,!0),w([l.range])}function g(e,l){o.selectActiveCell&&null!=l.row&&null!=l.cell?w([new Slick.Range(l.row,l.cell)]):o.selectActiveCell||w([])}function f(e){var l,n,o,t,c,i=s.getActiveCell(),r=e.ctrlKey||e.metaKey;!i||!e.shiftKey||r||e.altKey||37!=e.which&&39!=e.which&&38!=e.which&&40!=e.which||((r=a.slice()).length||r.push(new Slick.Range(i.row,i.cell)),t=(l=(l=r.pop()).contains(i.row,i.cell)?l:new Slick.Range(i.row,i.cell)).toRow-l.fromRow,c=l.toCell-l.fromCell,n=i.row==l.fromRow?1:-1,o=i.cell==l.fromCell?1:-1,37==e.which?c-=o:39==e.which?c+=o:38==e.which?t-=n:40==e.which&&(t+=n),u([t=new Slick.Range(i.row,i.cell,i.row+n*t,i.cell+o*c)]).length?(r.push(t),i=0<n?t.toRow:t.fromRow,c=0<o?t.toCell:t.fromCell,s.scrollRowIntoView(i),s.scrollCellIntoView(i,c)):r.push(l),w(r),e.preventDefault(),e.stopPropagation())}Slick.Utils.extend(this,{getSelectedRanges:e,setSelectedRanges:w,refreshSelections:function(){w(a)},init:function(e){o=Slick.Utils.extend(!0,{},c,l),(s=e).onActiveCellChanged.subscribe(g),s.onKeyDown.subscribe(f),e.registerPlugin(n),n.onCellRangeSelected.subscribe(r),n.onBeforeCellRangeSelected.subscribe(i)},destroy:function(){s.onActiveCellChanged.unsubscribe(g),s.onKeyDown.unsubscribe(f),n.onCellRangeSelected.unsubscribe(r),n.onBeforeCellRangeSelected.unsubscribe(i),s.unregisterPlugin(n),n&&n.destroy&&n.destroy()},pluginName:"CellSelectionModel",onSelectedRangesChanged:new Slick.Event})}}})}(window);