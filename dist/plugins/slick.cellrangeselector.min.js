/**
 * SlickGrid v4.0.0
 * (c) 2009-present Michael Leibman
 * homepage: http://github.com/mleibman/slickgrid
 * license: MIT
 * date: 2023-06-28
 * file: ./plugins/slick.cellrangeselector.js
 */
!function(e){Slick.Utils.extend(!0,e,{Slick:{CellRangeSelector:function(s){var r,a,i,c,n,f,g,u,d,w,p,v,S,m,h,C,o,b,x,y=this,t=new Slick.EventHandler,l={autoScroll:!0,minIntervalToShowNextCell:30,maxIntervalToShowNextCell:600,accelerateInterval:5,selectionCss:{border:"2px dashed blue"}},I=!1,R=0,k=0;function N(e,t){R=t.scrollTop,k=t.scrollLeft}function D(e){n=r.getActiveCanvasNode(e),v=r.getActiveViewportNode(e);var t=r.getDisplayedScrollbarDimensions();S=v.offsetWidth-t.width,m=v.offsetHeight-t.height,C={x:r.getAbsoluteColumnMinWidth()/2,y:r.getOptions().rowHeight/2},I=!(!r.getPluginByName("RowMoveManager")&&!r.getPluginByName("CrossGridRowMoveManager")),d=u=0,p=n.classList.contains("grid-canvas-bottom"),-1<c.frozenRow&&p&&(t=`.${r.getUID()} .grid-canvas-`+(c.frozenBottom?"bottom":"top"),t=document.querySelector(t))&&(u=t.clientHeight||0),w=n.classList.contains("grid-canvas-right"),-1<c.frozenColumn&&w&&(t=document.querySelector(`.${r.getUID()} .grid-canvas-left`))&&(d=t.clientWidth||0),e.stopImmediatePropagation(),e.preventDefault()}function z(o,l){var n=r.getCellFromEvent(o);if(!1!==y.onBeforeCellRangeSelected.notify(n)&&r.canCellBeSelected(n.row,n.cell)&&(f=!0,o.stopImmediatePropagation()),f){r.focus();n=Slick.Utils.offset(i);let e=l.startX-(n.left||0),t=(0<=c.frozenColumn&&w&&(e+=k),l.startY-(n.top||0));0<=c.frozenRow&&p&&(t+=R);o=r.getCellFromPoint(e,t);return l.range={start:o,end:{}},a=l.range,g.show(new Slick.Range(o.row,o.cell))}}function T(e,t){if(f||I){I||e.stopImmediatePropagation();var i,c,e=e.getNativeEvent();if(s.autoScroll)if((h=function(e,t){var o=e.touches?e.touches[0]:e,l=v.scrollLeft,n=v.scrollTop,r=l+S,a=n+m,i=Slick.Utils.offset(v),c=i.left||0,i=i.top||0,s=c+S,f=i+m,e={e:e,dd:t,viewport:{left:l,top:n,right:r,bottom:a,offset:{left:c,top:i,right:s,bottom:f}},offset:{x:0,y:0},isOutsideViewport:!1};o.pageX<c?e.offset.x=o.pageX-c:o.pageX>s&&(e.offset.x=o.pageX-s);o.pageY<i?e.offset.y=i-o.pageY:o.pageY>f&&(e.offset.y=f-o.pageY);return e.isOutsideViewport=!!e.offset.x||!!e.offset.y,e}(e,t)).isOutsideViewport)return b=s.maxIntervalToShowNextCell-Math.abs(h.offset.x)*s.accelerateInterval,x=s.maxIntervalToShowNextCell-Math.abs(h.offset.y)*s.accelerateInterval,void(o||(c=i=0,o=setInterval(function(){var e,t,o,l,n,r=!1,a=!1;h.offset.x?(i+=s.minIntervalToShowNextCell,r=b<=i):i=0,h.offset.y?(c+=s.minIntervalToShowNextCell,a=x<=c):c=0,(r||a)&&(r&&(i=0),a&&(c=0),r=r,a=a,e=h.e.pageX,t=h.e.pageY,o=h.offset.x,l=h.offset.y,n=h.viewport.offset,r&&o&&(e=0<o?n.right+C.x:n.left-C.x),a&&l&&(t=0<l?n.top-C.y:n.bottom+C.y),E({pageX:e,pageY:t},h.dd))},s.minIntervalToShowNextCell)));B(),E(e,t)}}function B(){clearInterval(o),o=null}function E(e,t){var e=e.touches?e.touches[0]:e,o=Slick.Utils.offset(n),e=r.getCellFromPoint(e.pageX-(o&&o.left||0)+d,e.pageY-(o&&o.top||0)+u);if(!(0<=c.frozenColumn&&!w&&e.cell>c.frozenColumn||w&&e.cell<=c.frozenColumn||0<=c.frozenRow&&!p&&e.row>=c.frozenRow||p&&e.row<c.frozenRow)){if(s.autoScroll&&h){var o=r.getCellNodeBox(e.row,e.cell);if(!o)return;var l=h.viewport;(o.left<l.left||o.right>l.right||o.top<l.top||o.bottom>l.bottom)&&r.scrollCellIntoView(e.row,e.cell)}r.canCellBeSelected(e.row,e.cell)&&t&&t.range&&(t.range.end=e,o=new Slick.Range(t.range.start.row,t.range.start.cell,e.row,e.cell),g.show(o),y.onCellRangeSelecting.notify({range:o}))}}function P(e,t){f&&(f=!1,e.stopImmediatePropagation(),B(),g.hide(),y.onCellRangeSelected.notify({range:new Slick.Range(t.range.start.row,t.range.start.cell,t.range.end.row,t.range.end.cell)}))}Slick.Utils.extend(this,{init:function(e){if(void 0===Slick.Draggable)throw new Error('Slick.Draggable is undefined, make sure to import "slick.interactions.js"');s=Slick.Utils.extend(!0,{},l,s),g=s.cellDecorator||new Slick.CellRangeDecorator(e,s),i=(r=e).getCanvasNode(),c=r.getOptions(),t.subscribe(r.onScroll,N).subscribe(r.onDragInit,D).subscribe(r.onDragStart,z).subscribe(r.onDrag,T).subscribe(r.onDragEnd,P)},destroy:function(){t.unsubscribeAll(),i=v=n=null,g&&g.destroy&&g.destroy()},pluginName:"CellRangeSelector",getCellDecorator:function(){return g},getCurrentRange:function(){return a},onBeforeCellRangeSelected:new Slick.Event,onCellRangeSelected:new Slick.Event,onCellRangeSelecting:new Slick.Event})}}})}(window);