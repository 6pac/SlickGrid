{
  "version": 3,
  "sources": ["../../../src/plugins/slick.headerbuttons.ts"],
  "sourcesContent": ["import type {\r\n  Column,\r\n  DOMEvent,\r\n  HeaderButtonItem,\r\n  HeaderButtonOnCommandArgs,\r\n  HeaderButtonOption,\r\n  OnHeaderCellRenderedEventArgs,\r\n  SlickPlugin\r\n} from '../models/index.js';\r\nimport { BindingEventService as BindingEventService_, EventHandler as EventHandler_, SlickEvent as SlickEvent_, type SlickEventData, Utils as Utils_ } from '../slick.core.js';\r\nimport type { SlickGrid } from '../slick.grid.js';\r\n\r\n// for (iife) load Slick methods from global Slick object, or use imports for (esm)\r\nconst BindingEventService = IIFE_ONLY ? Slick.BindingEventService : BindingEventService_;\r\nconst SlickEvent = IIFE_ONLY ? Slick.Event : SlickEvent_;\r\nconst EventHandler = IIFE_ONLY ? Slick.EventHandler : EventHandler_;\r\nconst Utils = IIFE_ONLY ? Slick.Utils : Utils_;\r\n\r\n/***\r\n   * A plugin to add custom buttons to column headers.\r\n   *\r\n   * USAGE:\r\n   *\r\n   * Add the plugin .js & .css files and register it with the grid.\r\n   *\r\n   * To specify a custom button in a column header, extend the column definition like so:\r\n   *\r\n   *   let columns = [\r\n   *     {\r\n   *       id: 'myColumn',\r\n   *       name: 'My column',\r\n   *\r\n   *       // This is the relevant part\r\n   *       header: {\r\n   *          buttons: [\r\n   *              {\r\n   *                // button options\r\n   *              },\r\n   *              {\r\n   *                // button options\r\n   *              }\r\n   *          ]\r\n   *       }\r\n   *     }\r\n   *   ];\r\n   *\r\n   * Available button options:\r\n   *    cssClass:     CSS class to add to the button.\r\n   *    image:        Relative button image path.\r\n   *    disabled:     Whether the item is disabled.\r\n   *    tooltip:      Button tooltip.\r\n   *    showOnHover:  Only show the button on hover.\r\n   *    handler:      Button click handler.\r\n   *    command:      A command identifier to be passed to the onCommand event handlers.\r\n   *\r\n   * Available menu item options:\r\n   *    action:                   Optionally define a callback function that gets executed when item is chosen (and/or use the onCommand event)\r\n   *    command:                  A command identifier to be passed to the onCommand event handlers.\r\n   *    cssClass:                 CSS class to add to the button.\r\n   *    handler:                  Button click handler.\r\n   *    image:                    Relative button image path.\r\n   *    showOnHover:              Only show the button on hover.\r\n   *    tooltip:                  Button tooltip.\r\n   *    itemVisibilityOverride:   Callback method that user can override the default behavior of showing/hiding an item from the list\r\n   *    itemUsabilityOverride:    Callback method that user can override the default behavior of enabling/disabling an item from the list\r\n   *\r\n   * The plugin exposes the following events:\r\n   *    onCommand:    Fired on button click for buttons with 'command' specified.\r\n   *        Event args:\r\n   *            grid:     Reference to the grid.\r\n   *            column:   Column definition.\r\n   *            command:  Button command identified.\r\n   *            button:   Button options.  Note that you can change the button options in your\r\n   *                      event handler, and the column header will be automatically updated to\r\n   *                      reflect them.  This is useful if you want to implement something like a\r\n   *                      toggle button.\r\n   *\r\n   *\r\n   * @param options {Object} Options:\r\n   *    buttonCssClass:   a CSS class to use for buttons (default 'slick-header-button')\r\n   * @class Slick.Plugins.HeaderButtons\r\n   * @constructor\r\n   */\r\nexport class SlickHeaderButtons implements SlickPlugin {\r\n  // --\r\n  // public API\r\n  pluginName = 'HeaderButtons' as const;\r\n  onCommand = new SlickEvent<HeaderButtonOnCommandArgs>('onCommand');\r\n\r\n  // --\r\n  // protected props\r\n  protected _grid!: SlickGrid;\r\n  protected _handler = new EventHandler();\r\n  protected _bindingEventService = new BindingEventService();\r\n  protected _defaults: HeaderButtonOption = {\r\n    buttonCssClass: 'slick-header-button'\r\n  };\r\n  protected _options: HeaderButtonOption;\r\n\r\n  constructor(options: Partial<HeaderButtonOption>) {\r\n    this._options = Utils.extend(true, {}, this._defaults, options);\r\n  }\r\n\r\n  init(grid: SlickGrid) {\r\n    this._grid = grid;\r\n    Utils.addSlickEventPubSubWhenDefined(grid.getPubSubService(), this);\r\n    this._handler\r\n      .subscribe(this._grid.onHeaderCellRendered, this.handleHeaderCellRendered.bind(this))\r\n      .subscribe(this._grid.onBeforeHeaderCellDestroy, this.handleBeforeHeaderCellDestroy.bind(this));\r\n\r\n    // Force the grid to re-render the header now that the events are hooked up.\r\n    this._grid.setColumns(this._grid.getColumns());\r\n  }\r\n\r\n  destroy() {\r\n    this._handler.unsubscribeAll();\r\n    this._bindingEventService.unbindAll();\r\n  }\r\n\r\n  protected handleHeaderCellRendered(_e: SlickEventData, args: OnHeaderCellRenderedEventArgs) {\r\n    const column = args.column;\r\n\r\n    if (column.header?.buttons) {\r\n      // Append buttons in reverse order since they are floated to the right.\r\n      let i = column.header.buttons.length;\r\n      while (i--) {\r\n        const button = column.header.buttons[i];\r\n\r\n        // run each override functions to know if the item is visible and usable\r\n        const isItemVisible = this.runOverrideFunctionWhenExists<typeof args>(button.itemVisibilityOverride, args);\r\n        const isItemUsable = this.runOverrideFunctionWhenExists<typeof args>(button.itemUsabilityOverride, args);\r\n\r\n        // if the result is not visible then there's no need to go further\r\n        if (!isItemVisible) {\r\n          continue;\r\n        }\r\n\r\n        // when the override is defined, we need to use its result to update the disabled property\r\n        // so that \"handleMenuItemCommandClick\" has the correct flag and won't trigger a command clicked event\r\n        if (Object.prototype.hasOwnProperty.call(button, 'itemUsabilityOverride')) {\r\n          button.disabled = isItemUsable ? false : true;\r\n        }\r\n\r\n        const btn = document.createElement('div');\r\n        btn.className = this._options.buttonCssClass || '';\r\n        btn.ariaLabel = 'Header Button';\r\n        btn.role = 'button';\r\n\r\n        if (button.disabled) {\r\n          btn.classList.add('slick-header-button-disabled');\r\n        }\r\n\r\n        if (button.showOnHover) {\r\n          btn.classList.add('slick-header-button-hidden');\r\n        }\r\n\r\n        if (button.image) {\r\n          btn.style.backgroundImage = `url(${button.image})`;\r\n        }\r\n\r\n        if (button.cssClass) {\r\n          btn.classList.add(...Utils.classNameToList(button.cssClass));\r\n        }\r\n\r\n        if (button.tooltip) {\r\n          btn.title = button.tooltip;\r\n        }\r\n\r\n        if (button.handler && !button.disabled) {\r\n          this._bindingEventService.bind(btn, 'click', button.handler);\r\n        }\r\n\r\n        this._bindingEventService.bind(btn, 'click', this.handleButtonClick.bind(this, button, args.column) as EventListener);\r\n        args.node.appendChild(btn);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  protected handleBeforeHeaderCellDestroy(_e: SlickEventData, args: { column: Column; node: HTMLElement; }) {\r\n    const column = args.column;\r\n\r\n    if (column.header?.buttons) {\r\n      // Removing buttons via jQuery will also clean up any event handlers and data.\r\n      // NOTE: If you attach event handlers directly or using a different framework,\r\n      //       you must also clean them up here to avoid memory leaks.\r\n      const buttonCssClass = (this._options.buttonCssClass || '').replace(/(\\s+)/g, '.');\r\n      if (buttonCssClass) {\r\n        args.node.querySelectorAll(`.${buttonCssClass}`).forEach(elm => elm.remove());\r\n      }\r\n    }\r\n  }\r\n\r\n  protected handleButtonClick(button: HeaderButtonItem, columnDef: Column, e: DOMEvent<HTMLDivElement>) {\r\n    const command = button.command || '';\r\n    const callbackArgs = {\r\n      grid: this._grid,\r\n      column: columnDef,\r\n      button\r\n    } as HeaderButtonOnCommandArgs;\r\n\r\n    if (command) {\r\n      callbackArgs.command = command;\r\n    }\r\n\r\n    // execute action callback when defined\r\n    if (typeof button.action === 'function') {\r\n      button.action.call(this, e, callbackArgs);\r\n    }\r\n\r\n    if (command && !button.disabled) {\r\n      this.onCommand.notify(callbackArgs, e, this);\r\n\r\n      // Update the header in case the user updated the button definition in the handler.\r\n      this._grid.updateColumnHeader(columnDef.id);\r\n    }\r\n\r\n    // Stop propagation so that it doesn't register as a header click event.\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n\r\n  /**\r\n   * Method that user can pass to override the default behavior.\r\n   * In order word, user can choose or an item is (usable/visible/enable) by providing his own logic.\r\n   * @param overrideFn: override function callback\r\n   * @param args: multiple arguments provided to the override (cell, row, columnDef, dataContext, grid)\r\n   */\r\n  protected runOverrideFunctionWhenExists<T = any>(overrideFn: ((args: any) => boolean) | undefined, args: T): boolean {\r\n    if (typeof overrideFn === 'function') {\r\n      return overrideFn.call(this, args);\r\n    }\r\n    return true;\r\n  }\r\n}\r\n\r\n// extend Slick namespace on window object when building as iife\r\nif (IIFE_ONLY && window.Slick) {\r\n  Utils.extend(true, window, {\r\n    Slick: {\r\n      Plugins: {\r\n        HeaderButtons: SlickHeaderButtons\r\n      }\r\n    }\r\n  });\r\n}\r\n"],
  "mappings": ";;;;;;;AAaA,MAAM,sBAAkC,MAAM,qBACxC,aAAyB,MAAM,OAC/B,eAA2B,MAAM,cACjC,QAAoB,MAAM,OAmEnB,qBAAN,MAAgD;AAAA,IAgBrD,YAAY,SAAsC;AAblD;AAAA;AAAA,wCAAa;AACb,uCAAY,IAAI,WAAsC,WAAW;AAIjE;AAAA;AAAA,0BAAU;AACV,0BAAU,YAAW,IAAI,aAAa;AACtC,0BAAU,wBAAuB,IAAI,oBAAoB;AACzD,0BAAU,aAAgC;AAAA,QACxC,gBAAgB;AAAA,MAClB;AACA,0BAAU;AAGR,WAAK,WAAW,MAAM,OAAO,IAAM,CAAC,GAAG,KAAK,WAAW,OAAO;AAAA,IAChE;AAAA,IAEA,KAAK,MAAiB;AACpB,WAAK,QAAQ,MACb,MAAM,+BAA+B,KAAK,iBAAiB,GAAG,IAAI,GAClE,KAAK,SACF,UAAU,KAAK,MAAM,sBAAsB,KAAK,yBAAyB,KAAK,IAAI,CAAC,EACnF,UAAU,KAAK,MAAM,2BAA2B,KAAK,8BAA8B,KAAK,IAAI,CAAC,GAGhG,KAAK,MAAM,WAAW,KAAK,MAAM,WAAW,CAAC;AAAA,IAC/C;AAAA,IAEA,UAAU;AACR,WAAK,SAAS,eAAe,GAC7B,KAAK,qBAAqB,UAAU;AAAA,IACtC;AAAA,IAEU,yBAAyB,IAAoB,MAAqC;AAvH9F;AAwHI,UAAM,SAAS,KAAK;AAEpB,WAAI,YAAO,WAAP,WAAe,SAAS;AAE1B,YAAI,IAAI,OAAO,OAAO,QAAQ;AAC9B,eAAO,OAAK;AACV,cAAM,SAAS,OAAO,OAAO,QAAQ,CAAC,GAGhC,gBAAgB,KAAK,8BAA2C,OAAO,wBAAwB,IAAI,GACnG,eAAe,KAAK,8BAA2C,OAAO,uBAAuB,IAAI;AAGvG,cAAI,CAAC;AACH;AAKF,UAAI,OAAO,UAAU,eAAe,KAAK,QAAQ,uBAAuB,MACtE,OAAO,WAAW;AAGpB,cAAM,MAAM,SAAS,cAAc,KAAK;AACxC,cAAI,YAAY,KAAK,SAAS,kBAAkB,IAChD,IAAI,YAAY,iBAChB,IAAI,OAAO,UAEP,OAAO,YACT,IAAI,UAAU,IAAI,8BAA8B,GAG9C,OAAO,eACT,IAAI,UAAU,IAAI,4BAA4B,GAG5C,OAAO,UACT,IAAI,MAAM,kBAAkB,OAAO,OAAO,KAAK,MAG7C,OAAO,YACT,IAAI,UAAU,IAAI,GAAG,MAAM,gBAAgB,OAAO,QAAQ,CAAC,GAGzD,OAAO,YACT,IAAI,QAAQ,OAAO,UAGjB,OAAO,WAAW,CAAC,OAAO,YAC5B,KAAK,qBAAqB,KAAK,KAAK,SAAS,OAAO,OAAO,GAG7D,KAAK,qBAAqB,KAAK,KAAK,SAAS,KAAK,kBAAkB,KAAK,MAAM,QAAQ,KAAK,MAAM,CAAkB,GACpH,KAAK,KAAK,YAAY,GAAG;AAAA,QAC3B;AAAA,MACF;AAAA,IACF;AAAA,IAGU,8BAA8B,IAAoB,MAA8C;AAnL5G;AAsLI,WAAI,KAFW,KAAK,OAET,WAAP,WAAe,SAAS;AAI1B,YAAM,kBAAkB,KAAK,SAAS,kBAAkB,IAAI,QAAQ,UAAU,GAAG;AACjF,QAAI,kBACF,KAAK,KAAK,iBAAiB,IAAI,cAAc,EAAE,EAAE,QAAQ,SAAO,IAAI,OAAO,CAAC;AAAA,MAEhF;AAAA,IACF;AAAA,IAEU,kBAAkB,QAA0B,WAAmB,GAA6B;AACpG,UAAM,UAAU,OAAO,WAAW,IAC5B,eAAe;AAAA,QACnB,MAAM,KAAK;AAAA,QACX,QAAQ;AAAA,QACR;AAAA,MACF;AAEA,MAAI,YACF,aAAa,UAAU,UAIrB,OAAO,OAAO,UAAW,cAC3B,OAAO,OAAO,KAAK,MAAM,GAAG,YAAY,GAGtC,WAAW,CAAC,OAAO,aACrB,KAAK,UAAU,OAAO,cAAc,GAAG,IAAI,GAG3C,KAAK,MAAM,mBAAmB,UAAU,EAAE,IAI5C,EAAE,eAAe,GACjB,EAAE,gBAAgB;AAAA,IACpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAQU,8BAAuC,YAAkD,MAAkB;AACnH,aAAI,OAAO,cAAe,aACjB,WAAW,KAAK,MAAM,IAAI,IAE5B;AAAA,IACT;AAAA,EACF;AAGA,EAAiB,OAAO,SACtB,MAAM,OAAO,IAAM,QAAQ;AAAA,IACzB,OAAO;AAAA,MACL,SAAS;AAAA,QACP,eAAe;AAAA,MACjB;AAAA,IACF;AAAA,EACF,CAAC;",
  "names": []
}
