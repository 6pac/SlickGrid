{
  "version": 3,
  "sources": ["../../../src/plugins/slick.cellcopymanager.ts"],
  "sourcesContent": ["import type { CssStyleHash, SlickPlugin } from '../models/index';\nimport { SlickEvent as SlickEvent_, keyCode as keyCode_, Utils as Utils_, SlickRange } from '../slick.core';\nimport type { SlickGrid } from '../slick.grid';\n\n// for (iife) load Slick methods from global Slick object, or use imports for (esm)\nconst keyCode = IIFE_ONLY ? Slick.keyCode : keyCode_;\nconst SlickEvent = IIFE_ONLY ? Slick.Event : SlickEvent_;\nconst Utils = IIFE_ONLY ? Slick.Utils : Utils_;\n\n/**\n * This manager enables users to copy/paste cell data\n */\nexport class SlickCellCopyManager implements SlickPlugin {\n  // --\n  // public API\n  pluginName = 'CellCopyManager' as const;\n  onCopyCells = new SlickEvent<{ ranges: SlickRange[] | null; }>('onCopyCells');\n  onCopyCancelled = new SlickEvent<{ ranges: SlickRange[] | null; }>('onCopyCancelled');\n  onPasteCells = new SlickEvent<{ from: SlickRange[] | undefined; to: SlickRange[] | undefined; }>('onPasteCells');\n\n  // --\n  // protected props\n  protected _grid!: SlickGrid;\n  protected _copiedRanges?: SlickRange[] | null = null;\n\n  init(grid: SlickGrid) {\n    this._grid = grid;\n    Utils.addSlickEventPubSubWhenDefined(grid.getPubSubService(), this);\n    this._grid.onKeyDown.subscribe(this.handleKeyDown.bind(this));\n  }\n\n  destroy() {\n    this._grid.onKeyDown.unsubscribe(this.handleKeyDown.bind(this));\n  }\n\n  protected handleKeyDown(e: KeyboardEvent) {\n    let ranges: SlickRange[] | undefined;\n    if (!this._grid.getEditorLock().isActive()) {\n      if (e.which === keyCode.ESCAPE) {\n        if (this._copiedRanges) {\n          e.preventDefault();\n          this.clearCopySelection();\n          this.onCopyCancelled.notify({ ranges: this._copiedRanges });\n          this._copiedRanges = null;\n        }\n      }\n\n      if (e.which === 67 && (e.ctrlKey || e.metaKey)) {\n        ranges = this._grid.getSelectionModel()?.getSelectedRanges() ?? [];\n        if (ranges.length !== 0) {\n          e.preventDefault();\n          this._copiedRanges = ranges;\n          this.markCopySelection(ranges);\n          this.onCopyCells.notify({ ranges });\n        }\n      }\n\n      if (e.which === 86 && (e.ctrlKey || e.metaKey)) {\n        if (this._copiedRanges) {\n          e.preventDefault();\n          ranges = this._grid.getSelectionModel()?.getSelectedRanges();\n          this.onPasteCells.notify({ from: this._copiedRanges, to: ranges });\n          if (!this._grid.getOptions().preserveCopiedSelectionOnPaste) {\n            this.clearCopySelection();\n            this._copiedRanges = null;\n          }\n        }\n      }\n    }\n  }\n\n  protected markCopySelection(ranges: SlickRange[]) {\n    const columns = this._grid.getColumns();\n    const hash: CssStyleHash = {};\n    for (let i = 0; i < ranges.length; i++) {\n      for (let j = ranges[i].fromRow; j <= ranges[i].toRow; j++) {\n        hash[j] = {};\n        for (let k = ranges[i].fromCell; k <= ranges[i].toCell; k++) {\n          hash[j][columns[k].id] = 'copied';\n        }\n      }\n    }\n    this._grid.setCellCssStyles('copy-manager', hash);\n  }\n\n  protected clearCopySelection() {\n    this._grid.removeCellCssStyles('copy-manager');\n  }\n}\n\n// extend Slick namespace on window object when building as iife\nif (IIFE_ONLY && window.Slick) {\n  Utils.extend(true, window, {\n    Slick: {\n      CellCopyManager: SlickCellCopyManager\n    }\n  });\n}\n"],
  "mappings": ";;;;;;;AAKA,MAAM,UAAsB,MAAM,SAC5B,aAAyB,MAAM,OAC/B,QAAoB,MAAM,OAKnB,uBAAN,MAAkD;AAAA,IAAlD;AAGL;AAAA;AAAA,wCAAa;AACb,yCAAc,IAAI,WAA6C,aAAa;AAC5E,6CAAkB,IAAI,WAA6C,iBAAiB;AACpF,0CAAe,IAAI,WAA8E,cAAc;AAI/G;AAAA;AAAA,0BAAU;AACV,0BAAU,iBAAsC;AAAA;AAAA,IAEhD,KAAK,MAAiB;AACpB,WAAK,QAAQ,MACb,MAAM,+BAA+B,KAAK,iBAAiB,GAAG,IAAI,GAClE,KAAK,MAAM,UAAU,UAAU,KAAK,cAAc,KAAK,IAAI,CAAC;AAAA,IAC9D;AAAA,IAEA,UAAU;AACR,WAAK,MAAM,UAAU,YAAY,KAAK,cAAc,KAAK,IAAI,CAAC;AAAA,IAChE;AAAA,IAEU,cAAc,GAAkB;AAnC5C;AAoCI,UAAI;AACJ,MAAK,KAAK,MAAM,cAAc,EAAE,SAAS,MACnC,EAAE,UAAU,QAAQ,UAClB,KAAK,kBACP,EAAE,eAAe,GACjB,KAAK,mBAAmB,GACxB,KAAK,gBAAgB,OAAO,EAAE,QAAQ,KAAK,cAAc,CAAC,GAC1D,KAAK,gBAAgB,OAIrB,EAAE,UAAU,OAAO,EAAE,WAAW,EAAE,aACpC,UAAS,gBAAK,MAAM,kBAAkB,MAA7B,mBAAgC,wBAAhC,YAAuD,CAAC,GAC7D,OAAO,WAAW,MACpB,EAAE,eAAe,GACjB,KAAK,gBAAgB,QACrB,KAAK,kBAAkB,MAAM,GAC7B,KAAK,YAAY,OAAO,EAAE,OAAO,CAAC,KAIlC,EAAE,UAAU,OAAO,EAAE,WAAW,EAAE,YAChC,KAAK,kBACP,EAAE,eAAe,GACjB,UAAS,UAAK,MAAM,kBAAkB,MAA7B,mBAAgC,qBACzC,KAAK,aAAa,OAAO,EAAE,MAAM,KAAK,eAAe,IAAI,OAAO,CAAC,GAC5D,KAAK,MAAM,WAAW,EAAE,mCAC3B,KAAK,mBAAmB,GACxB,KAAK,gBAAgB;AAAA,IAK/B;AAAA,IAEU,kBAAkB,QAAsB;AAChD,UAAM,UAAU,KAAK,MAAM,WAAW,GAChC,OAAqB,CAAC;AAC5B,eAAS,IAAI,GAAG,IAAI,OAAO,QAAQ;AACjC,iBAAS,IAAI,OAAO,CAAC,EAAE,SAAS,KAAK,OAAO,CAAC,EAAE,OAAO,KAAK;AACzD,eAAK,CAAC,IAAI,CAAC;AACX,mBAAS,IAAI,OAAO,CAAC,EAAE,UAAU,KAAK,OAAO,CAAC,EAAE,QAAQ;AACtD,iBAAK,CAAC,EAAE,QAAQ,CAAC,EAAE,EAAE,IAAI;AAAA,QAE7B;AAEF,WAAK,MAAM,iBAAiB,gBAAgB,IAAI;AAAA,IAClD;AAAA,IAEU,qBAAqB;AAC7B,WAAK,MAAM,oBAAoB,cAAc;AAAA,IAC/C;AAAA,EACF;AAGA,EAAiB,OAAO,SACtB,MAAM,OAAO,IAAM,QAAQ;AAAA,IACzB,OAAO;AAAA,MACL,iBAAiB;AAAA,IACnB;AAAA,EACF,CAAC;",
  "names": []
}
