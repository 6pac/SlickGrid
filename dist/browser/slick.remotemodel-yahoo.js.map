{
  "version": 3,
  "sources": ["../../src/slick.remotemodel-yahoo.ts"],
  "sourcesContent": ["/***\n * A sample AJAX data store implementation.\n * Right now, it's hooked up to load Hackernews stories, but can\n * easily be extended to support any JSONP-compatible backend that accepts paging parameters.\n */\nexport class SlickRemoteModelYahoo {\n  // protected\n  protected PAGESIZE = 10;\n  protected data: any = { length: 0 };\n  protected h_request: any = null;\n  protected req: any = null; // ajax request\n\n  // events\n  protected onDataLoading = new Slick.Event('onDataLoading');\n  protected onDataLoaded = new Slick.Event('onDataLoaded');\n\n  constructor() {\n    if (!(window.$ || window.jQuery) || !window.$.jsonp) {\n      throw new Error('SlickRemoteModel requires both jQuery and jQuery jsonp library to be loaded.');\n    }\n    this.init();\n  }\n\n  init() { }\n\n  isDataLoaded(from: number, to: number) {\n    for (let i = from; i <= to; i++) {\n      if (this.data[i] === undefined || this.data[i] === null) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  clear() {\n    for (const key in this.data) {\n      delete this.data[key];\n    }\n    this.data.length = 0;\n  }\n\n  ensureData(from: number, to: number) {\n    if (this.req) {\n      this.req.abort();\n      for (let i = this.req.fromPage; i <= this.req.toPage; i++) {\n        this.data[i * this.PAGESIZE] = undefined;\n      }\n    }\n\n    if (from < 0) {\n      from = 0;\n    }\n\n    if (this.data.length > 0) {\n      to = Math.min(to, this.data.length - 1);\n    }\n\n    let fromPage = Math.floor(from / this.PAGESIZE);\n    let toPage = Math.floor(to / this.PAGESIZE);\n\n    while (this.data[fromPage * this.PAGESIZE] !== undefined && fromPage < toPage) {\n      fromPage++;\n    }\n    while (this.data[toPage * this.PAGESIZE] !== undefined && fromPage < toPage) {\n      toPage--;\n    }\n    if (fromPage > toPage || ((fromPage === toPage) && this.data[fromPage * this.PAGESIZE] !== undefined)) {\n      // TODO:  look-ahead\n      this.onDataLoaded.notify({ from, to });\n      return;\n    }\n\n    const recStart = (fromPage * this.PAGESIZE);\n    const recCount = (((toPage - fromPage) * this.PAGESIZE) + this.PAGESIZE);\n\n    const url = \"https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20rss\"\n      + \"(\" + recStart + \"%2C\" + recCount + \")\"\n      + \"%20where%20url%3D%22http%3A%2F%2Frss.news.yahoo.com%2Frss%2Ftopstories%22\"\n      + \"&format=json\";\n\n    if (this.h_request !== null) {\n      clearTimeout(this.h_request);\n    }\n\n    this.h_request = setTimeout(() => {\n      for (let i = fromPage; i <= toPage; i++) {\n        this.data[i * this.PAGESIZE] = null; // null indicates a 'requested but not available yet'\n      }\n      this.onDataLoading.notify({ from, to });\n\n      this.req = window.$.jsonp({\n        url,\n        callbackParameter: \"callback\",\n        cache: true,\n        success: (json: any) => {\n          this.onSuccess(json, recStart);\n        },\n        error: () => {\n          this.onError(fromPage, toPage);\n        }\n      });\n\n      this.req.fromPage = fromPage;\n      this.req.toPage = toPage;\n    }, 50);\n  }\n\n\n  onError(fromPage: number, toPage: number) {\n    alert(\"error loading pages \" + fromPage + \" to \" + toPage);\n  }\n\n  // SAMPLE DATA\n  //    {\n  //      \"query\": {\n  //        \"count\": 40,\n  //        \"created\": \"2015-03-03T00:34:00Z\",\n  //        \"lang\": \"en-US\",\n  //        \"results\": {\n  //          \"item\": [\n  //            {\n  //              \"title\": \"Netanyahu assails Iran deal, touts US-Israel ties\",\n  //              \"description\": \"<p><a href=\\\"http://news.yahoo.com/netanyahu-us-officials-face-off-iran-133539021--politics.html\\\"><img src=\\\"http://l2.yimg.com/bt/api/res/1.2/4eoBxbJStrbGAKbmBYOJfg--/YXBwaWQ9eW5ld3M7Zmk9ZmlsbDtoPTg2O3E9NzU7dz0xMzA-/http://media.zenfs.com/en_us/News/ap_webfeeds/2f3a20c2d46d9f096f0f6a706700d430.jpg\\\" width=\\\"130\\\" height=\\\"86\\\" alt=\\\"Israeli Prime Minister Benjamin Netanyahu addresses the 2015 American Israel Public Affairs Committee (AIPAC) Policy Conference in Washington, Monday, March 2, 2015. (AP Photo/Cliff Owen)\\\" align=\\\"left\\\" title=\\\"Israeli Prime Minister Benjamin Netanyahu addresses the 2015 American Israel Public Affairs Committee (AIPAC) Policy Conference in Washington, Monday, March 2, 2015. (AP Photo/Cliff Owen)\\\" border=\\\"0\\\" /></a>WASHINGTON (AP) \u2014 Seeking to lower tensions, Benjamin Netanyahu and U.S. officials cast their dispute over Iran as a family squabble on Monday, even as the Israeli leader claimed President Barack Obama did not \u2014 and could not \u2014 fully understand his nation&#039;s vital security concerns.</p><br clear=\\\"all\\\"/>\",\n  //              \"link\": \"http://news.yahoo.com/netanyahu-us-officials-face-off-iran-133539021--politics.html\",\n  //              \"pubDate\": \"Mon, 02 Mar 2015 19:17:36 -0500\",\n  //              \"source\": {\n  //                \"url\": \"http://www.ap.org/\",\n  //                \"content\": \"Associated Press\"\n  //              },\n  //              \"guid\": {\n  //                \"isPermaLink\": \"false\",\n  //                \"content\": \"netanyahu-us-officials-face-off-iran-133539021--politics\"\n  //              },\n  //              \"content\": {\n  //                \"height\": \"86\",\n  //                \"type\": \"image/jpeg\",\n  //                \"url\": \"http://l2.yimg.com/bt/api/res/1.2/4eoBxbJStrbGAKbmBYOJfg--/YXBwaWQ9eW5ld3M7Zmk9ZmlsbDtoPTg2O3E9NzU7dz0xMzA-/http://media.zenfs.com/en_us/News/ap_webfeeds/2f3a20c2d46d9f096f0f6a706700d430.jpg\",\n  //                \"width\": \"130\"\n  //              },\n  //              \"text\": {\n  //                \"type\": \"html\",\n  //                \"content\": \"<p><a href=\\\"http://news.yahoo.com/netanyahu-us-officials-face-off-iran-133539021--politics.html\\\"><img src=\\\"http://l2.yimg.com/bt/api/res/1.2/4eoBxbJStrbGAKbmBYOJfg--/YXBwaWQ9eW5ld3M7Zmk9ZmlsbDtoPTg2O3E9NzU7dz0xMzA-/http://media.zenfs.com/en_us/News/ap_webfeeds/2f3a20c2d46d9f096f0f6a706700d430.jpg\\\" width=\\\"130\\\" height=\\\"86\\\" alt=\\\"Israeli Prime Minister Benjamin Netanyahu addresses the 2015 American Israel Public Affairs Committee (AIPAC) Policy Conference in Washington, Monday, March 2, 2015. (AP Photo/Cliff Owen)\\\" align=\\\"left\\\" title=\\\"Israeli Prime Minister Benjamin Netanyahu addresses the 2015 American Israel Public Affairs Committee (AIPAC) Policy Conference in Washington, Monday, March 2, 2015. (AP Photo/Cliff Owen)\\\" border=\\\"0\\\" /></a>WASHINGTON (AP) \u2014 Seeking to lower tensions, Benjamin Netanyahu and U.S. officials cast their dispute over Iran as a family squabble on Monday, even as the Israeli leader claimed President Barack Obama did not \u2014 and could not \u2014 fully understand his nation&#039;s vital security concerns.</p><br clear=\\\"all\\\"/>\"\n  //              },\n  //              \"credit\": {\n  //                \"role\": \"publishing company\"\n  //              }\n  //            },\n  //            {... },\n  //            {... },\n  //          ]\n  //        }\n  //      }\n  //    }\n\n  onSuccess(json: any, recStart: number) {\n    let recEnd = recStart;\n    if (json.query.count > 0) {\n      const results = json.query.results.item;\n      recEnd = recStart + results.length;\n      this.data.length = 100;// Math.min(parseInt(results.length),1000); // limitation of the API\n\n      for (let i = 0; i < results.length; i++) {\n        const item = results[i];\n\n        item.pubDate = new Date(item.pubDate);\n\n        this.data[recStart + i] = { index: recStart + i };\n        this.data[recStart + i].pubDate = item.pubDate;\n        this.data[recStart + i].title = item.title;\n        this.data[recStart + i].url = item.link;\n        this.data[recStart + i].text = item.description;\n      }\n    }\n    this.req = null;\n\n    this.onDataLoaded.notify({ from: recStart, to: recEnd });\n  }\n\n\n  reloadData(from: number, to: number) {\n    for (let i = from; i <= to; i++) {\n      delete this.data[i];\n    }\n    this.ensureData(from, to);\n  }\n\n\n  // return {\n  //   // properties\n  //   \"data\": data,\n\n  //   // methods\n  //   \"clear\": clear,\n  //   \"isDataLoaded\": isDataLoaded,\n  //   \"ensureData\": ensureData,\n  //   \"reloadData\": reloadData,\n\n  //   // events\n  //   \"onDataLoading\": onDataLoading,\n  //   \"onDataLoaded\": onDataLoaded\n  // };\n}\n\n// extend Slick namespace on window object when building as iife\nif (IIFE_ONLY && window.Slick) {\n  window.Slick.Data = window.Slick.Data || {};\n  window.Slick.Data.RemoteModelYahoo = SlickRemoteModelYahoo;\n}"],
  "mappings": "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",
  "names": []
}
